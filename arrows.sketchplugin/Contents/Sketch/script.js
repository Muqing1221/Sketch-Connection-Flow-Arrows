var that=this;function __skpm_run(e,t){that.context=t;var r=function(e){var t={};function r(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/script.js")}({"./src/script.js":
/*!***********************!*\
  !*** ./src/script.js ***!
  \***********************/
/*! exports provided: default, updateSelectedArrows, updateArtboardArrows, updateAllArrows, deleteAllArrows, deleteArtboardArrows, deleteSelectedArrows, settings */function(e,r,a){"use strict";a.r(r),a.d(r,"updateSelectedArrows",function(){return g}),a.d(r,"updateArtboardArrows",function(){return S}),a.d(r,"updateAllArrows",function(){return b}),a.d(r,"deleteAllArrows",function(){return p}),a.d(r,"deleteArtboardArrows",function(){return w}),a.d(r,"deleteSelectedArrows",function(){return y}),a.d(r,"settings",function(){return v});var i,o,n=a(/*! sketch */"sketch"),s=a.n(n),l=a(/*! sketch/ui */"sketch/ui"),d="flowArrows",c=s.a.fromNative(t.document),m=t.document.documentData(),f=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",m,d),u=m.currentPage().currentArtboard()||m.currentPage(),h=A(),I=a(/*! sketch/settings */"sketch/settings");function g(e){var t=e.selection;if(t.count()>1){for(var r=x(t),a=h,i=0;i<t.count();i++)if(t[i].objectID()!=r){var n=D(r,t[i].objectID(),a);null!=n&&(T(a[n].firstObject,a[n].secondObject,o,a[n].line,n),s.a.UI.message("Current connection is updated 🚀"))}e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d)}else s.a.UI.message("Please select more than two layers")}function S(e){var t,r,a=e.selection,i=A();if(i.length>0){for(var o=i.length,n=0;n<o;n++)t=(t=c.getLayerWithID(i[n].firstObject)).sketchObject.parentArtboard().objectID(),r=(r=c.getLayerWithID(i[n].secondObject)).sketchObject.parentArtboard().objectID(),1==a.count()&&"MSArtboardGroup"==a[0].class()&&(t==a[0].objectID()&&r==a[0].objectID()?T(i[n].firstObject,i[n].secondObject,i[n].direction,i[n].line,n):h.push(i[n]));e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d),s.a.UI.message("All arrows are updated 🚀")}else s.a.UI.message("There is nothing to update")}function b(e){e.selection;var t=A();if(t.length>0){for(var r=t.length,a=0;a<r;a++)T(t[a].firstObject,t[a].secondObject,t[a].direction,t[a].line,a);e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d),s.a.UI.message("All arrows are updated 🚀")}else s.a.UI.message("There is nothing to update")}function p(e){if(h.length>0){for(var t=0;t<h.length;t++)k(h[t].line);e.command.setValue_forKey_onLayer_forPluginIdentifier(null,"arrowConnections",m,d),s.a.UI.message("All arrows are deleted")}else s.a.UI.message("There is nothing to delete")}function w(e){var t,r,a=e.selection;if(1==a.count()&&"MSArtboardGroup"==a[0].class()){var i=A();if(i.length>0){for(var o=i.length,n=0;n<o;n++)t=c.getLayerWithID(i[n].firstObject),r=c.getLayerWithID(i[n].secondObject),t.sketchObject.parentArtboard().objectID()==a[0].objectID()&&r.sketchObject.parentArtboard().objectID()==a[0].objectID()&&(k(i[n].line),h=j(n));e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d),s.a.UI.message("All arrows from selected artboard are deleted")}else s.a.UI.message("There is nothing to delete")}else s.a.UI.message("Please select one artboard")}function y(e){var t,r,a=e.selection;if(a.count()>1){for(var i=0;i<a.count();i++)if(a[i].objectID()!=a[0].objectID()){var o=A();if(null!=D(a[0].objectID(),a[i].objectID(),o)){for(var n=o.length,l=0;l<n;l++)t=c.getLayerWithID(o[l].firstObject),r=c.getLayerWithID(o[l].secondObject),t.sketchObject.parentArtboard().objectID()==a[0].objectID()&&r.sketchObject.parentArtboard().objectID()==a[0].objectID()&&(k(o[l].line),h=j(l));e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d),s.a.UI.message("All arrows from selected artboard are deleted")}}}else s.a.UI.message("Select some layers, please")}function v(e){var t=COSAlertWindow.new();t.setMessageText("Arrow Plugin Settings"),t.addButtonWithTitle("Update Settings"),t.addButtonWithTitle("Cancel");var r=NSView.alloc().initWithFrame(NSMakeRect(0,0,300,260));t.addAccessoryView(r),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,243,330,20))).setStringValue("Arrow Direction"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),r.addSubview(i);var a=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,220,300,20));!function(e){var t="Auto";I.settingForKey("arrowDirection")?("Auto"==(t=I.settingForKey("arrowDirection"))&&(e.addItemWithTitle("Auto"),e.lastItem().setState(1),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0)),"Right"==t&&(e.addItemWithTitle("Right"),e.lastItem().setState(1),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0)),"Down"==t&&(e.addItemWithTitle("Down"),e.lastItem().setState(1),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0)),"Left"==t&&(e.addItemWithTitle("Left"),e.lastItem().setState(1),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0)),"Up"==t&&(e.addItemWithTitle("Up"),e.lastItem().setState(1),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0))):(e.addItemWithTitle("Auto"),e.addItemWithTitle("Right"),e.addItemWithTitle("Down"),e.addItemWithTitle("Left"),e.addItemWithTitle("Up"))}(a),r.addSubview(a),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,176,280,40))).setStringValue("ℹ️ Auto mode will draw arrow based on location of the second object"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),r.addSubview(i),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,140,330,20))).setStringValue("Arrow Spacing"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),r.addSubview(i);var i,o=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,117,300,20));!function(e){var t="Not selected";I.settingForKey("arrowSpacing")?("Not selected"==(t=I.settingForKey("arrowSpacing"))&&(e.addItemWithTitle("Not selected"),e.lastItem().setState(1),e.addItemWithTitle("30px"),e.lastItem().setState(0),e.addItemWithTitle("70px"),e.lastItem().setState(0)),"30px"==t&&(e.addItemWithTitle("30px"),e.lastItem().setState(1),e.addItemWithTitle("70px"),e.lastItem().setState(0),e.addItemWithTitle("Not selected"),e.lastItem().setState(0)),"70px"==t&&(e.addItemWithTitle("70px"),e.lastItem().setState(1),e.addItemWithTitle("Not selected"),e.lastItem().setState(0),e.addItemWithTitle("30px"),e.lastItem().setState(0))):(e.addItemWithTitle("Not Selected"),e.addItemWithTitle("30px"),e.addItemWithTitle("70px"))}(o),r.addSubview(o),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,73,280,40))).setStringValue("ℹ️ If you will select spacing, the second layer position will be moved closer"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),r.addSubview(i),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,20,280,40))).setStringValue("Made by Farid Sabitov with the support of EPAM.com ❤️"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),r.addSubview(i),t.runModal()==NSAlertFirstButtonReturn&&(I.setSettingForKey("arrowDirection",t.views()[0].subviews()[1].title()),I.setSettingForKey("arrowSpacing",t.views()[0].subviews()[4].title()),l.message("Settings are updated 🚀"))}function T(e,t,r,a,i){var o=c.getLayerWithID(e),n=c.getLayerWithID(t);k(a),h=j(i),o&&n&&W(e,t,r)}function W(e,t,r){var o,n,s;!function(e,t,r){var a=c.getLayerWithID(e),i=c.getLayerWithID(t);if(I.settingForKey("arrowSpacing")){var o=I.settingForKey("arrowSpacing");"Right"==r&&("30px"==o&&(i.frame.x=a.frame.x+a.frame.width+30),"70px"==o&&(i.frame.x=a.frame.x+a.frame.width+70)),"Down"==r&&("30px"==o&&(i.frame.y=a.frame.y+a.frame.height+30),"70px"==o&&(i.frame.y=a.frame.y+a.frame.height+70)),"Left"==r&&("30px"==o&&(i.frame.x=a.frame.x-i.frame.width-30),"70px"==o&&(i.frame.x=a.frame.x-i.frame.width-70)),"Up"==r&&("30px"==o&&(i.frame.y=a.frame.y-i.frame.height-30),"70px"==o&&(i.frame.y=a.frame.y-i.frame.height-70))}}(n=_(e,t,o="Auto"==r?function(e,t){var r,a=c.getLayerWithID(e),i=c.getLayerWithID(t),o=a.frame.x+a.frame.width/2,n=a.frame.y+a.frame.height/2,s=i.frame.x+i.frame.width/2,l=i.frame.y+i.frame.height/2,d=o-s,m=n-l,f=Math.abs(d),u=Math.abs(m);r=s>o?l>n?d>m?"Down":"Right":f>u?"Right":"Up":l>n?f>u?"Left":"Down":d>m?"Left":"Up";return r}(e,t):r),s=n==e?t:e,o);var l=function(e,t,r){var a,i,o,n,s,l,d=c.getLayerWithID(e),m=c.getLayerWithID(t),f=NSBezierPath.bezierPath();"Up"==r&&(a=d.frame.x+d.frame.width/2,i=d.frame.y,o=m.frame.x+m.frame.width/2,n=m.frame.y+m.frame.height,s=(a+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(a,i)),f.lineToPoint(NSMakePoint(a,l)),f.lineToPoint(NSMakePoint(o,l)),f.lineToPoint(NSMakePoint(o,n)));"Right"==r&&(a=d.frame.x+d.frame.width,i=d.frame.y+d.frame.height/2,o=m.frame.x,n=m.frame.y+m.frame.height/2,s=(a+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(a,i)),f.lineToPoint(NSMakePoint(s,i)),f.lineToPoint(NSMakePoint(s,n)),f.lineToPoint(NSMakePoint(o,n)));"Down"==r&&(a=d.frame.x+d.frame.width/2,i=d.frame.y+d.frame.height,o=m.frame.x+m.frame.width/2,n=m.frame.y,s=(a+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(a,i)),f.lineToPoint(NSMakePoint(a,l)),f.lineToPoint(NSMakePoint(o,l)),f.lineToPoint(NSMakePoint(o,n)));"Left"==r&&(a=d.frame.x,i=d.frame.y+d.frame.height/2,o=m.frame.x+m.frame.width,n=m.frame.y+m.frame.height/2,s=(a+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(a,i)),f.lineToPoint(NSMakePoint(s,i)),f.lineToPoint(NSMakePoint(s,n)),f.lineToPoint(NSMakePoint(o,n)));var u=MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(f)),h=u.layers().firstObject().points();h[1].cornerRadius=20,h[2].cornerRadius=20,u.setName("Arrow");var I=u.style().addStylePartOfType(1);return I.color=MSColor.colorWithRGBADictionary({r:.89,g:.89,b:.89,a:1}),I.thickness=2,u.style().endMarkerType=2,u}(n,s,o);!function(e){if(i=function(){for(var e=0;e<u.layers().count();e++)"Arrows"==u.layers()[e].name()&&P(i=u.layers()[e]);return i}())i.addLayers([e]);else{var t=a(/*! sketch/dom */"sketch/dom").Group,r=new t({parent:u,name:"Arrows",locked:!0,layers:[e]});r.moveToBack()}}(l);var d={firstObject:n,secondObject:s,direction:o,line:l.objectID()};h.push(d)}function A(){var e=[],r=[];if(f){r=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",m,d);for(var a=0;a<r.length;a++)e.push(r[a])}return e}function D(e,t,r){var a=null;if(f)for(var i=0;i<r.length;i++)e!=r[i].firstObject&&e!=r[i].secondObject||t!=r[i].firstObject&&t!=r[i].secondObject||(a=i);return a}function j(e){var r=[];if(f)for(var a=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",m,d),i=0;i<a.length;i++)i!=e&&r.push(a[i]);return r}function P(e){log(e.layers().length);for(var t=0;t<e.layers().length;t++)log(e.layers()[t].objectID())}function k(e){var t,r=c.getLayerWithID(e);r&&(t=r.parent,r.remove(),0==t.layers.length&&t.remove())}function _(e,t,r){var a,i=c.getLayerWithID(e),o=c.getLayerWithID(t);return"Right"==r&&(a=i.frame.x<=o.frame.x?i.id:o.id),"Down"==r&&(a=i.frame.y<=o.frame.y?i.id:o.id),"Left"==r&&(a=i.frame.x<=o.frame.x?o.id:i.id),"Up"==r&&(a=i.frame.y<=o.frame.y?o.id:i.id),a}function x(e){var t=e.firstObject().objectID();if("Auto"!=o)for(var r=0;r<e.count();r++)t=_(t,e[r].objectID(),o);return t}o=I.settingForKey("arrowDirection")?I.settingForKey("arrowDirection"):"Auto",r.default=function(e){var t=e.selection;if(t.count()>1){for(var r=x(t),a=h,i=0;i<t.count();i++)if(t[i].objectID()!=r){var n=D(r,t[i].objectID(),a);null!=n?(T(a[n].firstObject,a[n].secondObject,o,a[n].line,n),s.a.UI.message("Current connection is updated 🚀")):(W(r,t[i].objectID(),o),s.a.UI.message("New connection is created 🚀"))}e.command.setValue_forKey_onLayer_forPluginIdentifier(h,"arrowConnections",m,d)}else s.a.UI.message("Please select more than two layers")}},sketch:
/*!*************************!*\
  !*** external "sketch" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("sketch")},"sketch/dom":
/*!*****************************!*\
  !*** external "sketch/dom" ***!
  \*****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/dom")},"sketch/settings":
/*!**********************************!*\
  !*** external "sketch/settings" ***!
  \**********************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/settings")},"sketch/ui":
/*!****************************!*\
  !*** external "sketch/ui" ***!
  \****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/ui")}});"default"===e&&"function"==typeof r?r(t):r[e](t)}that.onRun=__skpm_run.bind(this,"default"),that.updateSelectedArrows=__skpm_run.bind(this,"updateSelectedArrows"),that.updateArtboardArrows=__skpm_run.bind(this,"updateArtboardArrows"),that.updateAllArrows=__skpm_run.bind(this,"updateAllArrows"),that.deleteSelectedArrows=__skpm_run.bind(this,"deleteSelectedArrows"),that.deleteArtboardArrows=__skpm_run.bind(this,"deleteArtboardArrows"),that.deleteAllArrows=__skpm_run.bind(this,"deleteAllArrows"),that.settings=__skpm_run.bind(this,"settings");