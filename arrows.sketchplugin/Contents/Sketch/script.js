var that=this;function __skpm_run(e,t){that.context=t;var a=function(e){var t={};function a(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(r,i,function(t){return e[t]}.bind(null,i));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s="./src/script.js")}({"./src/script.js":
/*!***********************!*\
  !*** ./src/script.js ***!
  \***********************/
/*! exports provided: default, updateArrows, cleanArrows, settings */function(e,a,r){"use strict";r.r(a),r.d(a,"updateArrows",function(){return S}),r.d(a,"cleanArrows",function(){return p}),r.d(a,"settings",function(){return y});var i,o,n=r(/*! sketch */"sketch"),s=r.n(n),l=(r(/*! util */"util").toArray,r(/*! sketch/ui */"sketch/ui")),d=r(/*! sketch/dom */"sketch/dom").Group,c="flowArrows",m=s.a.fromNative(t.document),f=(m.selectedPage,t.document.documentData()),u=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",f,c),h=f.currentPage().currentArtboard()||f.currentPage(),I=W(),g=r(/*! sketch/settings */"sketch/settings");function S(e){var t,a,r=e.selection,i=W();if(i.length>0){for(var o=i.length,n=0;n<o;n++)t=(t=m.getLayerWithID(i[n].firstObject)).sketchObject.parentArtboard().objectID(),a=(a=m.getLayerWithID(i[n].secondObject)).sketchObject.parentArtboard().objectID(),1==r.count()&&"MSArtboardGroup"==r[0].class()?t==r[0].objectID()&&a==r[0].objectID()?w(i[n].firstObject,i[n].secondObject,i[n].direction,i[n].line,n):I.push(i[n]):w(i[n].firstObject,i[n].secondObject,i[n].direction,i[n].line,n);e.command.setValue_forKey_onLayer_forPluginIdentifier(I,"arrowConnections",f,c),s.a.UI.message("All arrows are updated 🚀")}else s.a.UI.message("There is nothing to update")}function p(e){var t=COSAlertWindow.new();t.setMessageText("Would you like to delete all the arrows?"),t.addButtonWithTitle("Delete Arrows"),t.addButtonWithTitle("Cancel");var a=NSView.alloc().initWithFrame(NSMakeRect(0,0,300,40));t.addAccessoryView(a);var r=NSTextField.alloc().initWithFrame(NSMakeRect(-1,0,330,40));if(r.setStringValue("ℹ️ You can select an artboard to delete all the arrows from selected one"),r.setSelectable(!1),r.setDrawsBackground(!1),r.setBezeled(!1),a.addSubview(r),t.runModal()==NSAlertFirstButtonReturn){var i,o,n=e.selection;if(1==n.count()&&"MSArtboardGroup"==n[0].class()){var l=W();if(l.length>0){for(var d=l.length,u=0;u<d;u++)i=m.getLayerWithID(l[u].firstObject),o=m.getLayerWithID(l[u].secondObject),i.sketchObject.parentArtboard().objectID()==n[0].objectID()&&o.sketchObject.parentArtboard().objectID()==n[0].objectID()&&(x(l[u].line),I=P(u));e.command.setValue_forKey_onLayer_forPluginIdentifier(I,"arrowConnections",f,c),s.a.UI.message("All arrows from selected artboard are deleted")}else s.a.UI.message("There is nothing to delete")}else if(I.length>0){for(var h=0;h<I.length;h++)x(I[h].line);e.command.setValue_forKey_onLayer_forPluginIdentifier(null,"arrowConnections",f,c),s.a.UI.message("All arrows are deleted")}else s.a.UI.message("There is nothing to delete")}}function y(e){var t=COSAlertWindow.new();t.setMessageText("Arrow Plugin Settings"),t.addButtonWithTitle("Update Settings"),t.addButtonWithTitle("Cancel");var a=NSView.alloc().initWithFrame(NSMakeRect(0,0,300,260));t.addAccessoryView(a),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,243,330,20))).setStringValue("Arrow Direction"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),a.addSubview(i);var r=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,220,300,20));!function(e){var t="Auto";g.settingForKey("arrowDirection")?("Auto"==(t=g.settingForKey("arrowDirection"))&&(e.addItemWithTitle("Auto"),e.lastItem().setState(1),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0)),"Right"==t&&(e.addItemWithTitle("Right"),e.lastItem().setState(1),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0)),"Down"==t&&(e.addItemWithTitle("Down"),e.lastItem().setState(1),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0)),"Left"==t&&(e.addItemWithTitle("Left"),e.lastItem().setState(1),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0)),"Up"==t&&(e.addItemWithTitle("Up"),e.lastItem().setState(1),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0))):(e.addItemWithTitle("Auto"),e.addItemWithTitle("Right"),e.addItemWithTitle("Down"),e.addItemWithTitle("Left"),e.addItemWithTitle("Up"))}(r),a.addSubview(r),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,176,280,40))).setStringValue("ℹ️ Auto mode will draw arrow based on location of the second object"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),a.addSubview(i),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,140,330,20))).setStringValue("Arrow Spacing"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),a.addSubview(i);var i,o=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,117,300,20));!function(e){var t="Not selected";g.settingForKey("arrowSpacing")?("Not selected"==(t=g.settingForKey("arrowSpacing"))&&(e.addItemWithTitle("Not selected"),e.lastItem().setState(1),e.addItemWithTitle("30px"),e.lastItem().setState(0),e.addItemWithTitle("70px"),e.lastItem().setState(0)),"30px"==t&&(e.addItemWithTitle("30px"),e.lastItem().setState(1),e.addItemWithTitle("70px"),e.lastItem().setState(0),e.addItemWithTitle("Not selected"),e.lastItem().setState(0)),"70px"==t&&(e.addItemWithTitle("70px"),e.lastItem().setState(1),e.addItemWithTitle("Not selected"),e.lastItem().setState(0),e.addItemWithTitle("30px"),e.lastItem().setState(0))):(e.addItemWithTitle("Not Selected"),e.addItemWithTitle("30px"),e.addItemWithTitle("70px"))}(o),a.addSubview(o),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,73,280,40))).setStringValue("ℹ️ If you will select spacing, the second layer position will be moved closer"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),a.addSubview(i),(i=NSTextField.alloc().initWithFrame(NSMakeRect(-1,20,280,40))).setStringValue("Made by Farid Sabitov and with the support of EPAM.com ❤️"),i.setSelectable(!1),i.setDrawsBackground(!1),i.setBezeled(!1),a.addSubview(i),t.runModal()==NSAlertFirstButtonReturn&&(g.setSettingForKey("arrowDirection",t.views()[0].subviews()[1].title()),g.setSettingForKey("arrowSpacing",t.views()[0].subviews()[4].title()),l.message("Settings are updated 🚀"))}function w(e,t,a,r,i){var o=m.getLayerWithID(e),n=m.getLayerWithID(t);x(r),I=P(i),o&&n&&b(e,t,a)}function b(e,t,a){var r,o,n;!function(e,t,a){var r=m.getLayerWithID(e),i=m.getLayerWithID(t);if(g.settingForKey("arrowSpacing")){var o=g.settingForKey("arrowSpacing");"Right"==a&&("30px"==o&&(i.frame.x=r.frame.x+r.frame.width+30),"70px"==o&&(i.frame.x=r.frame.x+r.frame.width+70)),"Down"==a&&("30px"==o&&(i.frame.y=r.frame.y+r.frame.height+30),"70px"==o&&(i.frame.y=r.frame.y+r.frame.height+70)),"Left"==a&&("30px"==o&&(i.frame.x=r.frame.x-i.frame.width-30),"70px"==o&&(i.frame.x=r.frame.x-i.frame.width-70)),"Up"==a&&("30px"==o&&(i.frame.y=r.frame.y-i.frame.height-30),"70px"==o&&(i.frame.y=r.frame.y-i.frame.height-70))}}(o=function(e,t,a){var r,i=m.getLayerWithID(e),o=m.getLayerWithID(t);"Right"==a&&(r=i.frame.x<=o.frame.x?i.id:o.id);"Down"==a&&(r=i.frame.y<=o.frame.y?i.id:o.id);"Left"==a&&(r=i.frame.x<=o.frame.x?o.id:i.id);"Up"==a&&(r=i.frame.y<=o.frame.y?o.id:i.id);return r}(e,t,r="Auto"==a?function(e,t){var a,r=m.getLayerWithID(e),i=m.getLayerWithID(t),o=r.frame.x+r.frame.width/2,n=r.frame.y+r.frame.height/2,s=i.frame.x+i.frame.width/2,l=i.frame.y+i.frame.height/2,d=o-s,c=n-l,f=Math.abs(d),u=Math.abs(c);a=s>o?l>n?d>c?"Down":"Right":f>u?"Right":"Up":l>n?f>u?"Left":"Down":d>c?"Left":"Up";return a}(e,t):a),n=o==e?t:e,r);var s=function(e,t,a){var r,i,o,n,s,l,d=m.getLayerWithID(e),c=m.getLayerWithID(t),f=NSBezierPath.bezierPath();"Up"==a&&(r=d.frame.x+d.frame.width/2,i=d.frame.y,o=c.frame.x+c.frame.width/2,n=c.frame.y+c.frame.height,s=(r+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(r,i)),f.lineToPoint(NSMakePoint(r,l)),f.lineToPoint(NSMakePoint(o,l)),f.lineToPoint(NSMakePoint(o,n)));"Right"==a&&(r=d.frame.x+d.frame.width,i=d.frame.y+d.frame.height/2,o=c.frame.x,n=c.frame.y+c.frame.height/2,s=(r+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(r,i)),f.lineToPoint(NSMakePoint(s,i)),f.lineToPoint(NSMakePoint(s,n)),f.lineToPoint(NSMakePoint(o,n)));"Down"==a&&(r=d.frame.x+d.frame.width/2,i=d.frame.y+d.frame.height,o=c.frame.x+c.frame.width/2,n=c.frame.y,s=(r+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(r,i)),f.lineToPoint(NSMakePoint(r,l)),f.lineToPoint(NSMakePoint(o,l)),f.lineToPoint(NSMakePoint(o,n)));"Left"==a&&(r=d.frame.x,i=d.frame.y+d.frame.height/2,o=c.frame.x+c.frame.width,n=c.frame.y+c.frame.height/2,s=(r+o)/2,l=(i+n)/2,f.moveToPoint(NSMakePoint(r,i)),f.lineToPoint(NSMakePoint(s,i)),f.lineToPoint(NSMakePoint(s,n)),f.lineToPoint(NSMakePoint(o,n)));var u=MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(f)),h=u.layers().firstObject().points();h[1].cornerRadius=20,h[2].cornerRadius=20,u.setName("Arrow");var I=u.style().addStylePartOfType(1);return I.color=MSColor.colorWithRGBADictionary({r:.89,g:.89,b:.89,a:1}),I.thickness=2,u.style().endMarkerType=2,u}(o,n,r);!function(e){if(i=T())i.addLayers([e]);else{var t=new d({parent:h,name:"Arrows",locked:!0,layers:[e]});t.moveToBack()}}(s);var l={firstObject:o,secondObject:n,direction:r,line:s.objectID()};I.push(l)}function T(){for(var e=0;e<h.layers().count();e++)"Arrows"==h.layers()[e].name()&&(i=h.layers()[e]);return i}function W(){var e=[],a=[];if(u){a=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",f,c);for(var r=0;r<a.length;r++)e.push(a[r])}return e}function v(e,a){var r=null;if(u)for(var i=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",f,c),o=0;o<i.count();o++)e!=i[o].firstObject&&e!=i[o].secondObject||a!=i[o].firstObject&&a!=i[o].secondObject||(r=o);return r}function P(e){var a=[];if(u)for(var r=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",f,c),i=0;i<r.length;i++)i!=e&&a.push(r[i]);return a}function x(e){var t,a=m.getLayerWithID(e);a&&(t=a.parent,a.remove(),0==t.layers.length&&t.remove())}o=g.settingForKey("arrowDirection")?g.settingForKey("arrowDirection"):"Auto",a.default=function(e){i=T();var t=e.selection;if(t.count()>1){for(var a=t.firstObject(),r=0;r<t.count();r++)if(t[r].objectID()!=a.objectID()){var n=v(t[r].objectID(),a.objectID());null!=n?(w(u[n].firstObject,u[n].secondObject,o,u[n].line,n),e.command.setValue_forKey_onLayer_forPluginIdentifier(I,"arrowConnections",f,c),s.a.UI.message("Current connection is updated 🚀")):(b(a.objectID(),t[r].objectID(),o),e.command.setValue_forKey_onLayer_forPluginIdentifier(I,"arrowConnections",f,c),s.a.UI.message("New connection is created 🚀"))}}else s.a.UI.message("Please select more than two layers")}},sketch:
/*!*************************!*\
  !*** external "sketch" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("sketch")},"sketch/dom":
/*!*****************************!*\
  !*** external "sketch/dom" ***!
  \*****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/dom")},"sketch/settings":
/*!**********************************!*\
  !*** external "sketch/settings" ***!
  \**********************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/settings")},"sketch/ui":
/*!****************************!*\
  !*** external "sketch/ui" ***!
  \****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/ui")},util:
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/*! no static exports found */function(e,t){e.exports=require("util")}});"default"===e&&"function"==typeof a?a(t):a[e](t)}that.onRun=__skpm_run.bind(this,"default"),that.updateArrows=__skpm_run.bind(this,"updateArrows"),that.cleanArrows=__skpm_run.bind(this,"cleanArrows"),that.settings=__skpm_run.bind(this,"settings");