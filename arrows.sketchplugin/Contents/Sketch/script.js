var that=this;function __skpm_run(e,t){that.context=t;var r=function(e){var t={};function r(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/script.js")}({"./src/script.js":
/*!***********************!*\
  !*** ./src/script.js ***!
  \***********************/
/*! exports provided: default, updateSelectedArrows, updateArtboardArrows, updateAllArrows, deleteAllArrows, deleteArtboardArrows, deleteSelectedArrows, settings, onLayersMoved, panel */function(e,r,a){"use strict";a.r(r),a.d(r,"updateSelectedArrows",function(){return g}),a.d(r,"updateArtboardArrows",function(){return I}),a.d(r,"updateAllArrows",function(){return y}),a.d(r,"deleteAllArrows",function(){return p}),a.d(r,"deleteArtboardArrows",function(){return S}),a.d(r,"deleteSelectedArrows",function(){return w}),a.d(r,"settings",function(){return b}),a.d(r,"onLayersMoved",function(){return v}),a.d(r,"panel",function(){return T});var i,n=a(/*! sketch */"sketch"),o=a.n(n),s=a(/*! sketch/ui */"sketch/ui"),l="flowArrows",d=o.a.fromNative(t.document),c=t.document.documentData(),f=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",c,l),m=c.currentPage().currentArtboard()||c.currentPage(),u=P(),h=a(/*! sketch/settings */"sketch/settings");function g(e){var t=e.selection;if(t.count()>1){for(var r=N(t),a=u,n=0;n<t.count();n++)if(t[n].objectID()!=r){var s=_(r,t[n].objectID(),a);null!=s&&(W(a[s].firstObject,a[s].secondObject,i,a[s].line,s),o.a.UI.message("Current connection is updated 🚀"))}e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l)}else o.a.UI.message("Please select more than two layers")}function I(e){var t,r,a=e.selection,i=P();if(i.length>0){for(var n=i.length,s=0;s<n;s++)t=(t=d.getLayerWithID(i[s].firstObject)).sketchObject.parentArtboard().objectID(),r=(r=d.getLayerWithID(i[s].secondObject)).sketchObject.parentArtboard().objectID(),1==a.count()&&"MSArtboardGroup"==a[0].class()&&(t==a[0].objectID()&&r==a[0].objectID()?W(i[s].firstObject,i[s].secondObject,i[s].direction,i[s].line,s):u.push(i[s]));e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l),o.a.UI.message("All arrows are updated 🚀")}else o.a.UI.message("There is nothing to update")}function y(e){e.selection;var t=P();if(t.length>0){for(var r=t.length,a=0;a<r;a++)W(t[a].firstObject,t[a].secondObject,t[a].direction,t[a].line,a);e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l),o.a.UI.message("All arrows are updated 🚀")}else o.a.UI.message("There is nothing to update")}function p(e){if(u.length>0){for(var t=0;t<u.length;t++)k(u[t].line);e.command.setValue_forKey_onLayer_forPluginIdentifier(null,"arrowConnections",c,l),o.a.UI.message("All arrows are deleted")}else o.a.UI.message("There is nothing to delete")}function S(e){var t,r,a=e.selection;if(1==a.count()&&"MSArtboardGroup"==a[0].class()){var i=P();if(i.length>0){for(var n=i.length,s=0;s<n;s++)t=d.getLayerWithID(i[s].firstObject),r=d.getLayerWithID(i[s].secondObject),t.sketchObject.parentArtboard().objectID()==a[0].objectID()&&r.sketchObject.parentArtboard().objectID()==a[0].objectID()&&(k(i[s].line),u=j(s));e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l),o.a.UI.message("All arrows from selected artboard are deleted")}else o.a.UI.message("There is nothing to delete")}else o.a.UI.message("Please select one artboard")}function w(e){var t,r,a=e.selection;if(2==a.count()){for(var i=0;i<a.count();i++)if(a[i].objectID()!=a[0].objectID()){var n=P(),s=_(a[0].objectID(),a[i].objectID(),n);if(null!=s){k(n[s].line),u=j(s);for(var f=n.length,m=0;m<f;m++)t=d.getLayerWithID(n[m].firstObject),r=d.getLayerWithID(n[m].secondObject),t.sketchObject.parentArtboard().objectID()==a[0].objectID()&&r.sketchObject.parentArtboard().objectID()==a[0].objectID()&&(k(n[m].line),u=j(m));e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l),o.a.UI.message("All arrows from selected layers are deleted ✌️")}}}else o.a.UI.message("Select two layers, please 🧐")}function b(e){var t=COSAlertWindow.new();t=function(e,t,r){return e.setMessageText("Arrow Plugin Settings"),e.addButtonWithTitle("Update Settings"),e.addButtonWithTitle("Cancel"),e}(t);var r=NSView.alloc().initWithFrame(NSMakeRect(0,0,300,330));t.addAccessoryView(r);var a=M("Arrow Direction",!0,-1,313,330,20);r.addSubview(a);var i=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,290,300,20));!function(e){var t="Auto";h.settingForKey("arrowDirection")?("Auto"==(t=h.settingForKey("arrowDirection"))&&(e.addItemWithTitle("Auto"),e.lastItem().setState(1),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0)),"Right"==t&&(e.addItemWithTitle("Right"),e.lastItem().setState(1),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0)),"Down"==t&&(e.addItemWithTitle("Down"),e.lastItem().setState(1),e.addItemWithTitle("Left"),e.lastItem().setState(0),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0)),"Left"==t&&(e.addItemWithTitle("Left"),e.lastItem().setState(1),e.addItemWithTitle("Up"),e.lastItem().setState(0),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0)),"Up"==t&&(e.addItemWithTitle("Up"),e.lastItem().setState(1),e.addItemWithTitle("Auto"),e.lastItem().setState(0),e.addItemWithTitle("Right"),e.lastItem().setState(0),e.addItemWithTitle("Down"),e.lastItem().setState(0),e.addItemWithTitle("Left"),e.lastItem().setState(0))):(e.addItemWithTitle("Auto"),e.addItemWithTitle("Right"),e.addItemWithTitle("Down"),e.addItemWithTitle("Left"),e.addItemWithTitle("Up"))}(i),r.addSubview(i);var n=M("Auto mode will draw arrow based on location of the second object",!1,-1,246,280,40);r.addSubview(n);var o=M("Arrow Spacing",!0,-1,210,330,20);r.addSubview(o);var l=NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2,187,300,20));!function(e){var t="Not selected";h.settingForKey("arrowSpacing")?("Not selected"==(t=h.settingForKey("arrowSpacing"))&&(e.addItemWithTitle("Not selected"),e.lastItem().setState(1),e.addItemWithTitle("30px"),e.lastItem().setState(0),e.addItemWithTitle("70px"),e.lastItem().setState(0)),"30px"==t&&(e.addItemWithTitle("30px"),e.lastItem().setState(1),e.addItemWithTitle("70px"),e.lastItem().setState(0),e.addItemWithTitle("Not selected"),e.lastItem().setState(0)),"70px"==t&&(e.addItemWithTitle("70px"),e.lastItem().setState(1),e.addItemWithTitle("Not selected"),e.lastItem().setState(0),e.addItemWithTitle("30px"),e.lastItem().setState(0))):(e.addItemWithTitle("Not Selected"),e.addItemWithTitle("30px"),e.addItemWithTitle("70px"))}(l),r.addSubview(l);var d=M("If you will select spacing, the second layer position will be moved closer",!1,-1,143,280,40);r.addSubview(d);var c=M("Other Settings",!0,-1,90,280,40);r.addSubview(c);var f=function(e,t,r,a,i,n){var o=NSButton.alloc().initWithFrame(NSMakeRect(r,a,i,n));if(o.setButtonType(NSSwitchButton),o.setBezelStyle(0),o.setTitle(e),h.settingForKey("autoAlign")){var s=h.settingForKey("autoAlign");o.setState(s)}else o.setState(t);return o}("Second layer auto-align",!1,-1,80,280,40);r.addSubview(f);var m=M("Align the second layer for 5px misalignment with the first one",!1,-1,50,280,40);r.addSubview(m);var u=M("Made by @faridSabitov with the support of EPAM.com ❤️",!0,-1,0,280,40);r.addSubview(u),t.runModal()==NSAlertFirstButtonReturn&&(h.setSettingForKey("arrowDirection",t.views()[0].subviews()[1].title()),h.setSettingForKey("arrowSpacing",t.views()[0].subviews()[4].title()),h.setSettingForKey("autoAlign",t.views()[0].subviews()[7].state()),s.message("Settings are updated 🚀"))}function v(e){o.a.UI.message("Please select more than two layers");e.actionContext}function T(e){var t;(t=NSPanel.alloc().init()).setStyleMask(NSTitledWindowMask+NSFullSizeContentViewWindowMask),t.setTitleVisibility(NSWindowTitleHidden),t.setTitlebarAppearsTransparent(!0),t.setFrame_display(NSMakeRect(0,0,720,50),!1),t.setMovableByWindowBackground(!0),t.setHasShadow(!0),t.setLevel(NSFloatingWindowLevel),t.center(),t.makeKeyAndOrderFront(nil)}function W(e,t,r,a,i){var n=d.getLayerWithID(e),o=d.getLayerWithID(t);k(a),u=j(i),n&&o&&A(e,t,r)}function A(e,t,r){var i;(function(e,t,r){var a=d.getLayerWithID(e),i=d.getLayerWithID(t);if(h.settingForKey("arrowSpacing")){var n=h.settingForKey("arrowSpacing");"Right"==r&&("30px"==n&&(i.frame.x=a.frame.x+a.frame.width+30),"70px"==n&&(i.frame.x=a.frame.x+a.frame.width+70)),"Down"==r&&("30px"==n&&(i.frame.y=a.frame.y+a.frame.height+30),"70px"==n&&(i.frame.y=a.frame.y+a.frame.height+70)),"Left"==r&&("30px"==n&&(i.frame.x=a.frame.x-i.frame.width-30),"70px"==n&&(i.frame.x=a.frame.x-i.frame.width-70)),"Up"==r&&("30px"==n&&(i.frame.y=a.frame.y-i.frame.height-30),"70px"==n&&(i.frame.y=a.frame.y-i.frame.height-70))}})(e,t,i="Auto"==r?function(e,t){var r,a=d.getLayerWithID(e),i=d.getLayerWithID(t),n=a.frame.x+a.frame.width/2,o=a.frame.y+a.frame.height/2,s=i.frame.x+i.frame.width/2,l=i.frame.y+i.frame.height/2,c=n-s,f=o-l,m=Math.abs(c),u=Math.abs(f);r=s>n?l>o?c>f?"Down":"Right":m>u?"Right":"Up":l>o?m>u?"Left":"Down":c>f?"Left":"Up";return r}(e,t):r),function(e,t,r){var a,i,n,o,s,l=d.getLayerWithID(e),c=d.getLayerWithID(t);h.settingForKey("autoAlign")&&1==h.settingForKey("autoAlign")&&("Right"!=r&&"Left"!=r||(a=l.frame.y+l.frame.height/2,i=c.frame.y+c.frame.height/2,(s=a-i)>-6&&s<6&&(c.frame.y=c.frame.y+s)),"Down"!=r&&"Up"!=r||(n=l.frame.x+l.frame.width/2,o=c.frame.x+c.frame.width/2,(s=n-o)>-6&&s<6&&(c.frame.x=c.frame.x+s)))}(e,t,i);var n=D(),o=function(e,t,r,a){var i,n,o,s,l,c,f,m,u=d.getLayerWithID(e),h=d.getLayerWithID(t);a?(f=a.frame().x(),m=a.frame().y()):(f=0,m=0);var g=NSBezierPath.bezierPath();"Up"==r&&(i=u.frame.x+u.frame.width/2-f,n=u.frame.y-m,o=h.frame.x+h.frame.width/2-f,s=h.frame.y+h.frame.height-m,l=(i+o)/2,c=(n+s)/2,g.moveToPoint(NSMakePoint(i,n)),g.lineToPoint(NSMakePoint(i,c)),g.lineToPoint(NSMakePoint(o,c)),g.lineToPoint(NSMakePoint(o,s)));"Right"==r&&(i=u.frame.x+u.frame.width-f,n=u.frame.y+u.frame.height/2-m,o=h.frame.x-f,s=h.frame.y+h.frame.height/2-m,l=(i+o)/2,c=(n+s)/2,g.moveToPoint(NSMakePoint(i,n)),g.lineToPoint(NSMakePoint(l,n)),g.lineToPoint(NSMakePoint(l,s)),g.lineToPoint(NSMakePoint(o,s)));"Down"==r&&(i=u.frame.x+u.frame.width/2-f,n=u.frame.y+u.frame.height-m,o=h.frame.x+h.frame.width/2-f,s=h.frame.y-m,l=(i+o)/2,c=(n+s)/2,g.moveToPoint(NSMakePoint(i,n)),g.lineToPoint(NSMakePoint(i,c)),g.lineToPoint(NSMakePoint(o,c)),g.lineToPoint(NSMakePoint(o,s)));"Left"==r&&(i=u.frame.x-f,n=u.frame.y+u.frame.height/2-m,o=h.frame.x+h.frame.width-f,s=h.frame.y+h.frame.height/2-m,l=(i+o)/2,c=(n+s)/2,g.moveToPoint(NSMakePoint(i,n)),g.lineToPoint(NSMakePoint(l,n)),g.lineToPoint(NSMakePoint(l,s)),g.lineToPoint(NSMakePoint(o,s)));var I=MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(g)),y=I.layers().firstObject().points();y[1].cornerRadius=20,y[2].cornerRadius=20,I.setName("Arrow");var p=I.style().addStylePartOfType(1);return p.color=MSColor.colorWithRGBADictionary({r:.89,g:.89,b:.89,a:1}),p.thickness=2,I.style().endMarkerType=2,I}(e,t,i,n);!function(e,t){if(t)t.addLayers([e]),t.fixGeometryWithOptions(1);else{var r=a(/*! sketch/dom */"sketch/dom").Group,i=new r({parent:m,name:"Arrows",locked:!0,layers:[e]});i.moveToBack(),(t=D()).fixGeometryWithOptions(1)}}(o,n);var s={firstObject:e,secondObject:t,direction:i,line:o.objectID()};u.push(s)}function D(){for(var e=null,t=0;t<m.layers().count();t++)"Arrows"==m.layers()[t].name()&&x(e=m.layers()[t]);return e}function P(){var e=[],r=[];if(f){r=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",c,l);for(var a=0;a<r.length;a++)e.push(r[a])}return e}function _(e,t,r){var a=null;if(e=String(e),t=String(t),f)for(var i=0;i<r.length;i++)e!=r[i].firstObject&&e!=r[i].secondObject||t!=r[i].firstObject&&t!=r[i].secondObject||(a=i);return a}function j(e){var r=[];if(f)for(var a=t.command.valueForKey_onLayer_forPluginIdentifier("arrowConnections",c,l),i=0;i<a.length;i++)i!=e&&r.push(a[i]);return r}function x(e){for(var t=0;t<e.layers().length;t++);}function k(e){var t,r=d.getLayerWithID(e);r&&(t=r.parent,r.remove(),0==t.layers.length&&t.remove())}function L(e,t,r){var a,i=d.getLayerWithID(e),n=d.getLayerWithID(t);return"Auto"==r&&(a=i.id),"Right"==r&&(a=i.frame.x<=n.frame.x?i.id:n.id),"Down"==r&&(a=i.frame.y<=n.frame.y?i.id:n.id),"Left"==r&&(a=i.frame.x<=n.frame.x?n.id:i.id),"Up"==r&&(a=i.frame.y<=n.frame.y?n.id:i.id),a}function N(e){var t=e.firstObject().objectID();if("Auto"!=i)for(var r=0;r<e.count();r++)t=L(t,e[r].objectID(),i);else t=L(t,e[0].objectID(),i);return t}function M(e,t,r,a,i,n){var o=NSTextField.alloc().initWithFrame(NSMakeRect(r,a,i,n));return o.setStringValue(e),o.setSelectable(!1),o.setDrawsBackground(!1),o.setBezeled(!1),0==t&&(o.textColor=NSColor.disabledControlTextColor()),o}i=h.settingForKey("arrowDirection")?h.settingForKey("arrowDirection"):"Auto",r.default=function(e){var t=e.selection;if(t.count()>1){for(var r=N(t),a=u,n=0;n<t.count();n++)if(t[n].objectID()!=r){var s=_(r,t[n].objectID(),a);null!=s?(W(a[s].firstObject,a[s].secondObject,i,a[s].line,s),o.a.UI.message("Current connection is updated 🚀")):(A(r,t[n].objectID(),i),o.a.UI.message("New connection is created 🚀"))}e.command.setValue_forKey_onLayer_forPluginIdentifier(u,"arrowConnections",c,l)}else o.a.UI.message("Please select more than two layers")}},sketch:
/*!*************************!*\
  !*** external "sketch" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("sketch")},"sketch/dom":
/*!*****************************!*\
  !*** external "sketch/dom" ***!
  \*****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/dom")},"sketch/settings":
/*!**********************************!*\
  !*** external "sketch/settings" ***!
  \**********************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/settings")},"sketch/ui":
/*!****************************!*\
  !*** external "sketch/ui" ***!
  \****************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/ui")}});"default"===e&&"function"==typeof r?r(t):r[e](t)}that.onRun=__skpm_run.bind(this,"default"),that.updateSelectedArrows=__skpm_run.bind(this,"updateSelectedArrows"),that.updateArtboardArrows=__skpm_run.bind(this,"updateArtboardArrows"),that.updateAllArrows=__skpm_run.bind(this,"updateAllArrows"),that.deleteSelectedArrows=__skpm_run.bind(this,"deleteSelectedArrows"),that.deleteArtboardArrows=__skpm_run.bind(this,"deleteArtboardArrows"),that.deleteAllArrows=__skpm_run.bind(this,"deleteAllArrows"),that.settings=__skpm_run.bind(this,"settings"),that.panel=__skpm_run.bind(this,"panel");